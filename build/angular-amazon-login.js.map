{"version":3,"sources":["angular-amazon-login.coffee"],"names":[],"mappings":"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","file":"angular-amazon-login.js","sourcesContent":["angular.module 'angular-amazon-login', []\n\n\n.provider 'AmazonLoginService', ->\n\t###\n\tPRIVATE:\n\t###\n\tconfig =\n\t\tclientId: null\n\t\tscriptUrl: 'https://api-cdn.amazon.com/sdk/login1.js'\n\t\ttimeout: 3000\n\n\tattachScript = (_document) ->\n\t\t###\n\t\tAppends a <script> tag for the SDK to the DOM.\n\t\t###\n\t\ttag = _document.createElement('script')\n\t\ttag.type = 'text/javascript'\n\t\ttag.src = config.scriptUrl\n\t\t# it's supposed to go into something with id=\"amazon-root\", but fallback to <head> otherwise\n\t\tdest = _document.getElementById('amazon-root') ? _document.getElementsByTagName('head')[0]\n\t\tdest.appendChild(tag)\n\n\t###\n\tPUBLIC:\n\t###\n\tself = \n\t\tsetScriptUrl: (value) ->\n\t\t\t###\n\t\t\tSets the URL of the JavaScript to load.\n\t\t\t###\n\t\t\tconfig.scriptUrl = value\n\t\t\treturn self\n\n\t\tsetClientId: (value) ->\n\t\t\t###\n\t\t\tSets the non-secret API key.\n\t\t\t###\n\t\t\tconfig.clientId = value\n\t\t\treturn self\n\n\t\tsetTimeout: (value) ->\n\t\t\tconfig.timeout = value\n\t\t\treturn self\n\n\t\t$get: ['$document', '$timeout', '$q', '$window', '$log', ($document, $timeout, $q, $window, $log) ->\n\t\t\t###\n\t\t\tReturns a promise that resolves to `amazon.Login`.\n\t\t\tOtherwise it rejects if it couldn't load it in time.\n\t\t\t###\n\t\t\td = $q.defer()\n\t\t\t# reject and log an error if it doesn't load in time\n\t\t\tloadFailureCallback = ->\n\t\t\t\t$log.error \"Amazon Login JavaScript SDK has not loaded after #{config.timeout}ms\"\n\t\t\t\td.reject()\n\t\t\tloadTimer = $timeout(loadFailureCallback, config.timeout)\n\t\t\t# resolve to `amazon.Login` once it's loaded\n\t\t\t$window.onAmazonLoginReady = ->\n\t\t\t\t# prevent the loadFailureCallback being triggered\n\t\t\t\t$timeout.cancel(loadTimer)\n\t\t\t\t$window.amazon.Login.setClientId(config.clientId)\n\t\t\t\t$log.debug \"amazon.Login has loaded successfully\"\n\t\t\t\td.resolve($window.amazon.Login)\n\t\t\t# create the script\n\t\t\tattachScript($document[0])\n\t\t\treturn d.promise\n\t\t]\n\n\n.factory 'AmazonLogin', ['$q', '$log', 'AmazonLoginService', ($q, $log, AmazonLoginService) ->\n\n\tauthorize: (options) ->\n\t\td = $q.defer()\n\t\tAmazonLoginService.then (amazonLogin) -> amazonLogin.authorize options, (resp) ->\n\t\t\tif not resp?.success\n\t\t\t\t$log.error \"amazon.Login.authorize failed due to #{resp.error}\"\n\t\t\t\t# reject with returned error message\n\t\t\t\td.reject(resp.error)\n\t\t\telse\n\t\t\t\td.resolve(resp)\n\t\treturn d.promise\n]"],"sourceRoot":"/source/"}